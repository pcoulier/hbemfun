/* gausspw.cpp
 *
 * Computes Gaussian points and weights for an n-dimensional grid.
 * For computational efficiency, these points and weigths are implemented
 * as a lookup table, up to 20 Gaussian points.
 *
 * If more than 20 Gaussian points are requested, points and weights for
 * a midpoint integration are returned. This is because a high-order
 * Gaussian integration results in a large oscillation of the integration
 * error.
 *
 * Stijn Francois
 * February 2006
 */

#include <new>
using namespace std;

void gausspw1D_nodiv(const int& nGauss, double* const xi,double* const H)
{ 
  if (nGauss<1) 
     throw("Number of Gaussian points should be a strictly positive");
  else if (nGauss==1)
  {
    xi[0]=0.0;
    H[0] =2.0;
  }
  else if (nGauss==2)
  {
    xi[0]=-5.773502691896258e-001;
    xi[1]= 5.773502691896258e-001;
    H[0]=1.0;
    H[1]=1.0;
  }
  else if (nGauss==3)
  {
    xi[0]=-7.745966692414835e-001;
    xi[1]= 0.0;
    xi[2]= 7.745966692414835e-001;
    H[0]=5.555555555555555e-001;
    H[1]=8.888888888888888e-001;
    H[2]=5.555555555555555e-001;
  }
  else if (nGauss==4)
  {
    xi[0]=-8.611363115940526e-001;
    xi[1]=-3.399810435848563e-001;
    xi[2]= 3.399810435848563e-001;
    xi[3]= 8.611363115940526e-001;
    H[0]=3.478548451374544e-001;
    H[1]=6.521451548625460e-001;
    H[2]=6.521451548625460e-001;
    H[3]=3.478548451374544e-001;
  }
  else if (nGauss==5)
  {
    xi[0]=9.061798459386640e-001;
    xi[1]=5.384693101056831e-001;
    xi[2]=0;
    xi[3]=-5.384693101056831e-001;
    xi[4]=-9.061798459386640e-001;
    H[0]=2.369268850561891e-001;
    H[1]=4.786286704993663e-001;
    H[2]=5.688888888888889e-001;
    H[3]=4.786286704993663e-001;
    H[4]=2.369268850561891e-001;
  }
  else if (nGauss==6)
  {
    xi[0]= 9.324695142031521e-001;
    xi[1]= 6.612093864662645e-001;
    xi[2]= 2.386191860831969e-001;
    xi[3]=-2.386191860831969e-001;
    xi[4]=-6.612093864662645e-001;
    xi[5]=-9.324695142031521e-001;
    H[0]=1.713244923791705e-001;
    H[1]=3.607615730481387e-001;
    H[2]=4.679139345726910e-001;
    H[3]=4.679139345726910e-001;
    H[4]=3.607615730481387e-001;
    H[5]=1.713244923791705e-001;
  }
  else if (nGauss==7)
  {
    xi[0]=-9.491079123427585e-001;
    xi[1]=-7.415311855993945e-001;
    xi[2]=-4.058451513773972e-001;
    xi[3]= 0.0;
    xi[4]= 4.058451513773972e-001;
    xi[5]= 7.415311855993945e-001;
    xi[6]= 9.491079123427585e-001;
    H[0]=1.294849661688697e-001;
    H[1]=2.797053914892768e-001;
    H[2]=3.818300505051190e-001;
    H[3]=4.179591836734694e-001;
    H[4]=3.818300505051190e-001;
    H[5]=2.797053914892768e-001;
    H[6]=1.294849661688697e-001;
  }
  else if (nGauss==8)
  {
    xi[0]=-9.602898564975363e-001;
    xi[1]=-7.966664774136267e-001;
    xi[2]=-5.255324099163290e-001;
    xi[3]=-1.834346424956498e-001;
    xi[4]= 1.834346424956498e-001;
    xi[5]= 5.255324099163290e-001;
    xi[6]= 7.966664774136267e-001;
    xi[7]= 9.602898564975363e-001;
    H[0]= 1.012285362903768e-001;
    H[1]= 2.223810344533744e-001;
    H[2]= 3.137066458778873e-001;
    H[3]= 3.626837833783621e-001;
    H[4]= 3.626837833783621e-001;
    H[5]= 3.137066458778873e-001;
    H[6]= 2.223810344533744e-001;
    H[7]= 1.012285362903768e-001;
  }
  else if (nGauss==9)
  {
    xi[0]=-9.681602395076261e-001;
    xi[1]=-8.360311073266358e-001;
    xi[2]=-6.133714327005905e-001;
    xi[3]=-3.242534234038089e-001;
    xi[4]= 0.0;
    xi[5]= 3.242534234038089e-001;
    xi[6]= 6.133714327005905e-001;
    xi[7]= 8.360311073266358e-001;
    xi[8]= 9.681602395076261e-001;
    H[0]=8.127438836157463e-002;
    H[1]=1.806481606948574e-001;
    H[2]=2.606106964029356e-001;
    H[3]=3.123470770400029e-001;
    H[4]=3.302393550012598e-001;
    H[5]=3.123470770400029e-001;
    H[6]=2.606106964029356e-001;
    H[7]=1.806481606948574e-001;
    H[8]=8.127438836157463e-002;
  }
  else if (nGauss==10)
  {
    xi[0]=-9.739065285171717e-001;
    xi[1]=-8.650633666889845e-001;
    xi[2]=-6.794095682990244e-001;
    xi[3]=-4.333953941292472e-001;
    xi[4]=-1.488743389816312e-001;
    xi[5]= 1.488743389816312e-001;
    xi[6]= 4.333953941292472e-001;
    xi[7]= 6.794095682990244e-001;
    xi[8]= 8.650633666889845e-001;
    xi[9]= 9.739065285171717e-001;
    H[0]=6.667134430868803e-002;
    H[1]=1.494513491505806e-001;
    H[2]=2.190863625159821e-001;
    H[3]=2.692667193099962e-001;
    H[4]=2.955242247147529e-001;
    H[5]=2.955242247147529e-001;
    H[6]=2.692667193099962e-001;
    H[7]=2.190863625159821e-001;
    H[8]=1.494513491505806e-001;
    H[9]=6.667134430868803e-002;
  }
  else if (nGauss==11)
  {
    xi[0]=-9.782286581460570e-001;
    xi[1] =-8.870625997680953e-001;
    xi[2] =-7.301520055740494e-001;
    xi[3] =-5.190961292068118e-001;
    xi[4] =-2.695431559523450e-001;
    xi[5] = 0.0;
    xi[6] = 2.695431559523450e-001;
    xi[7] = 5.190961292068118e-001;
    xi[8] = 7.301520055740494e-001;
    xi[9] = 8.870625997680953e-001;
    xi[10] = 9.782286581460570e-001;
    H[0]=5.566856711617354e-002;
    H[1]=1.255803694649041e-001;
    H[2]=1.862902109277340e-001;
    H[3]=2.331937645919902e-001;
    H[4]=2.628045445102467e-001;
    H[5]=2.729250867779006e-001;
    H[6]=2.628045445102467e-001;
    H[7]=2.331937645919902e-001;
    H[8]=1.862902109277340e-001;
    H[9]=1.255803694649041e-001;
    H[10]=5.566856711617354e-002;
  }
  else if (nGauss==12)
  {
    xi[0]=-9.815606342467192e-001;
    xi[1]=-9.041172563704748e-001;
    xi[2]=-7.699026741943047e-001;
    xi[3]=-5.873179542866175e-001;
    xi[4]=-3.678314989981802e-001;
    xi[5]=-1.252334085114689e-001;
    xi[6]= 1.252334085114689e-001;
    xi[7]= 3.678314989981802e-001;
    xi[8]= 5.873179542866175e-001;
    xi[9]= 7.699026741943047e-001;
    xi[10]= 9.041172563704748e-001;
    xi[11]= 9.815606342467192e-001;
    H[0]=4.717533638651180e-002;
    H[1]=1.069393259953181e-001;
    H[2]=1.600783285433461e-001;
    H[3]=2.031674267230658e-001;
    H[4]=2.334925365383548e-001;
    H[5]=2.491470458134029e-001;
    H[6]=2.491470458134029e-001;
    H[7]=2.334925365383548e-001;
    H[8]=2.031674267230658e-001;
    H[9]=1.600783285433461e-001;
    H[10]=1.069393259953181e-001;
    H[11]=4.717533638651180e-002;
  }
  else if (nGauss==13)
  {
    xi[0]=-9.841830547185881e-001;
    xi[1]=-9.175983992229779e-001;
    xi[2]=-8.015780907333099e-001;
    xi[3]= -6.423493394403402e-001;
    xi[4]= -4.484927510364469e-001;
    xi[5]= -2.304583159551348e-001;
    xi[6]=  0.0;
    xi[7]=  2.304583159551348e-001;
    xi[8]=  4.484927510364469e-001;
    xi[9]=  6.423493394403402e-001;
    xi[10]=  8.015780907333099e-001;
    xi[11]=  9.175983992229779e-001;
    xi[12]=  9.841830547185881e-001;
    H[0] =4.048400476531582e-002;
    H[1] =9.212149983772844e-002;
    H[2] =1.388735102197871e-001;
    H[3] =1.781459807619457e-001;
    H[4] =2.078160475368883e-001;
    H[5] =2.262831802628971e-001;
    H[6] =2.325515532308739e-001;
    H[7] =2.262831802628971e-001;
    H[8] =2.078160475368883e-001;
    H[9] =1.781459807619457e-001;
    H[10]=1.388735102197871e-001;
    H[11]=9.212149983772844e-002;
    H[12]=4.048400476531582e-002;
  }
  else if (nGauss==14)
  {
    xi[0]=-9.862838086968123e-001;
    xi[1]=-9.284348836635735e-001;
    xi[2]=-8.272013150697650e-001;
    xi[3]=-6.872929048116855e-001;
    xi[4] =-5.152486363581541e-001;
    xi[5] =-3.191123689278897e-001;
    xi[6] =-1.080549487073436e-001;
    xi[7] = 1.080549487073436e-001;
    xi[8] = 3.191123689278897e-001;
    xi[9] = 5.152486363581541e-001;
    xi[10] = 6.872929048116855e-001;
    xi[11] = 8.272013150697650e-001;
    xi[12] = 9.284348836635735e-001;
    xi[13] = 9.862838086968123e-001;
    H[0]=3.511946033175200e-002;
    H[1]=8.015808715976004e-002;
    H[2]=1.215185706879032e-001;
    H[3]=1.572031671581936e-001;
    H[4]=1.855383974779379e-001;
    H[5]=2.051984637212957e-001;
    H[6]=2.152638534631577e-001;
    H[7]=2.152638534631577e-001;
    H[8]=2.051984637212957e-001;
    H[9]=1.855383974779379e-001;
    H[10]=1.572031671581936e-001;
    H[11]=1.215185706879032e-001;
    H[12]=8.015808715976004e-002;
    H[13]=3.511946033175200e-002;
  }
  else if (nGauss==15)
  {
    xi[0]=-9.879925180204854e-001;
    xi[1]=-9.372733924007060e-001;
    xi[2]=-8.482065834104272e-001;
    xi[3]=-7.244177313601701e-001;
    xi[4]=-5.709721726085388e-001;
    xi[5] =-3.941513470775634e-001;
    xi[6] =-2.011940939974345e-001;
    xi[7] = 0;
    xi[8] = 2.011940939974345e-001;
    xi[9] = 3.941513470775634e-001;
    xi[10] = 5.709721726085388e-001;
    xi[11] = 7.244177313601701e-001;
    xi[12] = 8.482065834104272e-001;
    xi[13] = 9.372733924007060e-001;
    xi[14] = 9.879925180204854e-001;

    H[0] = 3.075324199611663e-002;
    H[1] = 7.036604748810814e-002;
    H[2] = 1.071592204671718e-001;
    H[3] = 1.395706779261542e-001;
    H[4] = 1.662692058169940e-001;
    H[5] = 1.861610000155621e-001;
    H[6] = 1.984314853271116e-001;
    H[7] = 2.025782419255613e-001;
    H[8] = 1.984314853271116e-001;
    H[9] = 1.861610000155621e-001;
    H[10]= 1.662692058169940e-001;
    H[11]= 1.395706779261542e-001;
    H[12]= 1.071592204671718e-001;
    H[13]= 7.036604748810814e-002;
    H[14]= 3.075324199611663e-002;
  }
  else if (nGauss==16)
  {
    xi[0]=-9.894009349916499e-001;
    xi[1]=-9.445750230732326e-001;
    xi[2]=-8.656312023878318e-001;
    xi[3]=-7.554044083550030e-001;
    xi[4]=-6.178762444026438e-001;
    xi[5]=-4.580167776572274e-001;
    xi[6]=-2.816035507792589e-001;
    xi[7]=-9.501250983763744e-002;
    xi[8]= 9.501250983763744e-002;
    xi[9]= 2.816035507792589e-001;
    xi[10]= 4.580167776572274e-001;
    xi[11]= 6.178762444026438e-001;
    xi[12]= 7.554044083550030e-001;
    xi[13]= 8.656312023878318e-001;
    xi[14]= 9.445750230732326e-001;
    xi[15]= 9.894009349916499e-001;
    H[0]=2.715245941175406e-002;
    H[1]=6.225352393864778e-002;
    H[2]=9.515851168249290e-002;
    H[3]=1.246289712555339e-001;
    H[4]=1.495959888165768e-001;
    H[5]=1.691565193950026e-001;
    H[6]=1.826034150449236e-001;
    H[7]=1.894506104550685e-001;
    H[8]=1.894506104550685e-001;
    H[9]=1.826034150449236e-001;
    H[10]=1.691565193950026e-001;
    H[11]=1.495959888165768e-001;
    H[12]=1.246289712555339e-001;
    H[13]=9.515851168249290e-002;
    H[14]=6.225352393864778e-002;
    H[15]=2.715245941175406e-002;
  }
  else if (nGauss==17)
  {
    xi[0]=-9.905754753144174e-001;
    xi[1]=-9.506755217687678e-001;
    xi[2]=-8.802391537269859e-001;
    xi[3]=-7.815140038968014e-001;
    xi[4]=-6.576711592166907e-001;
    xi[5]=-5.126905370864769e-001;
    xi[6]=-3.512317634538763e-001;
    xi[7]=-1.784841814958479e-001;
    xi[8]= 0.0;
    xi[9]= 1.784841814958479e-001;
    xi[10]= 3.512317634538763e-001;
    xi[11]= 5.126905370864769e-001;
    xi[12]= 6.576711592166907e-001;
    xi[13]= 7.815140038968014e-001;
    xi[14]= 8.802391537269859e-001;
    xi[15]= 9.506755217687678e-001;
    xi[16]= 9.905754753144174e-001;
    H[0]=2.414830286854793e-002;
    H[1]=5.545952937398713e-002;
    H[2]=8.503614831717916e-002;
    H[3]=1.118838471934039e-001;
    H[4]=1.351363684685255e-001;
    H[5]=1.540457610768104e-001;
    H[6]=1.680041021564499e-001;
    H[7]=1.765627053669926e-001;
    H[8]=1.794464703562065e-001;
    H[9]=1.765627053669926e-001;
    H[10]=1.680041021564499e-001;
    H[11]=1.540457610768104e-001;
    H[12]=1.351363684685255e-001;
    H[13]=1.118838471934039e-001;
    H[14]=8.503614831717916e-002;
    H[15]=5.545952937398713e-002;
    H[16]=2.414830286854793e-002;
  }
  else if (nGauss==18)
  {
    xi[0]=-9.915651684209309e-001;
    xi[1]=-9.558239495713977e-001;
    xi[2]=-8.926024664975558e-001;
    xi[3]=-8.037049589725231e-001;
    xi[4]=-6.916870430603532e-001;
    xi[5]=-5.597708310739475e-001;
    xi[6]=-4.117511614628426e-001;
    xi[7]=-2.518862256915055e-001;
    xi[8]=-8.477501304173531e-002;
    xi[9]= 8.477501304173531e-002;
    xi[10]= 2.518862256915055e-001;
    xi[11]= 4.117511614628426e-001;
    xi[12]= 5.597708310739475e-001;
    xi[13]= 6.916870430603532e-001;
    xi[14]= 8.037049589725231e-001;
    xi[15]= 8.926024664975558e-001;
    xi[16]= 9.558239495713977e-001;
    xi[17]= 9.915651684209309e-001;
    H[0]=2.161601352648335e-002;
    H[1]=4.971454889496928e-002;
    H[2]=7.642573025488890e-002;
    H[3]=1.009420441062870e-001;
    H[4]=1.225552067114784e-001;
    H[5]=1.406429146706506e-001;
    H[6]=1.546846751262654e-001;
    H[7]=1.642764837458327e-001;
    H[8]=1.691423829631435e-001;
    H[9]=1.691423829631435e-001;
    H[10]=1.642764837458327e-001;
    H[11]=1.546846751262654e-001;
    H[12]=1.406429146706506e-001;
    H[13]=1.225552067114784e-001;
    H[14]=1.009420441062870e-001;
    H[15]=7.642573025488890e-002;
    H[16]=4.971454889496928e-002;
    H[17]=2.161601352648335e-002;
  }
  else if (nGauss==19)
  {
    xi[0]=-9.924068438435844e-001;
    xi[1]=-9.602081521348300e-001;
    xi[2]=-9.031559036148179e-001;
    xi[3]=-8.227146565371428e-001;
    xi[4]=-7.209661773352294e-001;
    xi[5]=-6.005453046616810e-001;
    xi[6]=-4.645707413759609e-001;
    xi[7]=-3.165640999636298e-001;
    xi[8]=-1.603586456402254e-001;
    xi[9]= 0.0;
    xi[10]= 1.603586456402254e-001;
    xi[11]= 3.165640999636298e-001;
    xi[12]= 4.645707413759609e-001;
    xi[13]= 6.005453046616810e-001;
    xi[14]= 7.209661773352294e-001;
    xi[15]= 8.227146565371428e-001;
    xi[16]= 9.031559036148179e-001;
    xi[17]= 9.602081521348300e-001;
    xi[18]= 9.924068438435844e-001;
    H[0]=1.946178822972643e-002;
    H[1]=4.481422676569941e-002;
    H[2]=6.904454273764106e-002;
    H[3]=9.149002162244992e-002;
    H[4]=1.115666455473341e-001;
    H[5]=1.287539625393363e-001;
    H[6]=1.426067021736067e-001;
    H[7]=1.527660420658597e-001;
    H[8]=1.589688433939544e-001;
    H[9]=1.610544498487837e-001;
    H[10]=1.589688433939544e-001;
    H[11]=1.527660420658597e-001;
    H[12]=1.426067021736067e-001;
    H[13]=1.287539625393363e-001;
    H[14]=1.115666455473341e-001;
    H[15]=9.149002162244992e-002;
    H[16]=6.904454273764106e-002;
    H[17]=4.481422676569941e-002;
    H[18]=1.946178822972643e-002;
  }
  else if (nGauss==20)
  {
    xi[0]=-9.931285991850949e-001;
    xi[1]=-9.639719272779138e-001;
    xi[2]=-9.122344282513260e-001;
    xi[3]=-8.391169718222189e-001;
    xi[4]=-7.463319064601508e-001;
    xi[5]=-6.360536807265150e-001;
    xi[6]=-5.108670019508271e-001;
    xi[7]=-3.737060887154196e-001;
    xi[8]=-2.277858511416451e-001;
    xi[9]=-7.652652113349734e-002;
    xi[10]=  7.652652113349734e-002;
    xi[11]=  2.277858511416451e-001;
    xi[12]=  3.737060887154196e-001;
    xi[13]=  5.108670019508271e-001;
    xi[14]=  6.360536807265150e-001;
    xi[15]=  7.463319064601508e-001;
    xi[16]=  8.391169718222189e-001;
    xi[17]=  9.122344282513260e-001;
    xi[18]=  9.639719272779138e-001;
    xi[19]=  9.931285991850949e-001;
    H[0]=1.761400713915167e-002;
    H[1]=4.060142980038705e-002;
    H[2]=6.267204833410904e-002;
    H[3]=8.327674157670477e-002;
    H[4]=1.019301198172405e-001;
    H[5]=1.181945319615183e-001;
    H[6]=1.316886384491766e-001;
    H[7]=1.420961093183822e-001;
    H[8]=1.491729864726038e-001;
    H[9]=1.527533871307260e-001;
    H[10]=1.527533871307260e-001;
    H[11]=1.491729864726038e-001;
    H[12]=1.420961093183822e-001;
    H[13]=1.316886384491766e-001;
    H[14]=1.181945319615183e-001;
    H[15]=1.019301198172405e-001;
    H[16]=8.327674157670477e-002;
    H[17]=6.267204833410904e-002;
    H[18]=4.060142980038705e-002;
    H[19]=1.761400713915167e-002;
   }
   else
   {
     
     // Midpoint rule integration
     for (int iXi=0; iXi<nGauss; iXi++)
     {
       xi[iXi]=-1.0+(1.0+2.0*double(iXi))/double(nGauss);
       H[iXi]=2.0/double(nGauss);
     }
   }
}


void gausspw1D(const int& nEltDiv, const int& nGauss, double* const xi,
               double* const H)
{
  double* const xi1Dref=new(nothrow) double[nGauss];
  if (xi1Dref==0) throw("Out of memory.");
  double* const H1Dref=new(nothrow) double[nGauss];
  if (H1Dref==0) throw("Out of memory.");
  
  gausspw1D_nodiv(nGauss,xi1Dref,H1Dref);
  
  const double delta=2.0/double(nEltDiv);
  const double xi0=(delta/2.0)-1.0;
  for (int iDiv=0; iDiv<nEltDiv; iDiv++)
  {
    for (int iGauss=0; iGauss<nGauss; iGauss++)
    {
      xi[nGauss*iDiv+iGauss]=xi0+delta*iDiv+xi1Dref[iGauss]*delta/2.0;
      H[nGauss*iDiv+iGauss]=H1Dref[iGauss]*delta/2.0;
    }
  }
  delete [] xi1Dref;
  delete [] H1Dref;
}

void gausspw2D(const int& nEltDiv, const int &nGauss, double* const xi,
               double* const H)
{
   const int nXi=nEltDiv*nGauss;
   double* const xi1D=new(nothrow) double[nXi];
   if (xi1D==0) throw("Out of memory.");
   double* const H1D=new(nothrow) double[nXi];
   if (H1D==0) throw("Out of memory.");
   gausspw1D(nEltDiv,nGauss,xi1D,H1D);

   for (int ixi1=0; ixi1<nXi; ixi1++)
   {
     for (int ixi2=0; ixi2<nXi; ixi2++)
     {
       xi[0+nXi*ixi1+ixi2]=xi1D[ixi1];
       xi[nXi*nXi+nXi*ixi1+ixi2]=xi1D[ixi2];
       H[nXi*ixi1+ixi2]=H1D[ixi1]*H1D[ixi2];
     }
   }
  delete [] xi1D;
  delete [] H1D;
}


void gausspwtri(const int &nGauss, double* const xi ,double* const H)
{
  if (nGauss==3)
  {
    xi[0]=0.16666666666667;
    xi[1]=0.16666666666667;
    xi[2]=0.66666666666667;
    xi[3]=0.16666666666667;
    xi[4]=0.66666666666667;
    xi[5]=0.16666666666667;

    H[0]=0.16666666666667;
    H[1]=0.16666666666667;
    H[2]=0.16666666666666;
  }
  else if (nGauss==6)
  {
    xi[0]=0.44594849091596;
    xi[1]=0.10810301816808;
    xi[2]=0.44594849091596;
    xi[3]=0.09157621350977;
    xi[4]=0.81684757298046;
    xi[5]=0.09157621350977;
    xi[6]=0.44594849091596;
    xi[7]=0.44594849091596;
    xi[8]=0.10810301816808;
    xi[9]=0.09157621350977;
    xi[10]=0.09157621350977;
    xi[11]=0.81684757298046;

    H[0]=0.111690794839005;
    H[1]=0.111690794839005;
    H[2]=0.111690794839005;
    H[3]=0.054975871827661;
    H[4]=0.054975871827661;
    H[5]=0.054975871827661;
  }
  else if (nGauss==7)
  {
    xi[0]=0.33333333333333;
    xi[1]=0.47014206410512;
    xi[2]=0.05971587178976;
    xi[3]=0.47014206410512;
    xi[4]=0.10128650732347;
    xi[5]=0.79742698535306;
    xi[6]=0.10128650732347;
    xi[7]=0.33333333333333;
    xi[8]=0.47014206410512;
    xi[9]=0.47014206410512;
    xi[10]=0.05971587178976;
    xi[11]=0.10128650732347;
    xi[12]=0.10128650732347;
    xi[13]=0.79742698535306;

    H[0]=0.112500000000000;
    H[1]=0.066197076394253;
    H[2]=0.066197076394253;
    H[3]=0.066197076394253;
    H[4]=0.062969590272414;
    H[5]=0.062969590272414;
    H[6]=0.062969590272414;
  }
  else if (nGauss==16)
  {
    xi[0]=0.33333333333333;
    xi[1]=0.08141482341455;
    xi[2]=0.45929258829272;
    xi[3]=0.45929258829272;
    xi[4]=0.89890554336594;
    xi[5]=0.05054722831703;
    xi[6]=0.05054722831703;
    xi[7]=0.65886138449648;
    xi[8]=0.17056930775176;
    xi[9]=0.17056930775176;
    xi[10]=0.00839477740996;
    xi[11]=0.72849239295540;
    xi[12]=0.26311282963464;
    xi[13]=0.72849239295540;
    xi[14]=0.26311282963464;
    xi[15]=0.00839477740996;
    xi[16]=0.33333333333333;
    xi[17]=0.45929258829272;
    xi[18]=0.08141482341455;
    xi[19]=0.45929258829272;
    xi[20]=0.05054722831703;
    xi[21]=0.89890554336594;
    xi[22]=0.05054722831703;
    xi[23]=0.17056930775176;
    xi[24]=0.65886138449648;
    xi[25]=0.17056930775176;
    xi[26]=0.72849239295540;
    xi[27]=0.00839477740996;
    xi[28]=0.72849239295540;
    xi[29]=0.26311282963464;
    xi[30]=0.00839477740996;
    xi[31]=0.26311282963464;

    H[0]=0.072157803838893;
    H[1]=0.047545817133642;
    H[2]=0.047545817133642;
    H[3]=0.047545817133642;
    H[4]=0.016229248811599;
    H[5]=0.016229248811599;
    H[6]=0.016229248811599;
    H[7]=0.051608685267359;
    H[8]=0.051608685267359;
    H[9]=0.051608685267359;
    H[10]=0.013615157087217;
    H[11]=0.013615157087217;
    H[12]=0.013615157087217;
    H[13]=0.013615157087217;
    H[14]=0.013615157087217;
    H[15]=0.013615157087217;
  }
  else throw("Number of Gauss points for triangular elements should be 3,6,7 or 16.");
}
